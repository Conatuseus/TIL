# 29강. 인덱스 작성과 삭제



~~~ sql
// 인덱스 작성, 삭제 SYNTAX
CREATE INDEX
DROP INDEX
~~~

인덱스는 데이터베이스 객체의 하나로 DDL을 사용해서 작성하거나 삭제합니다. 표준 SQL에는 CREATE INDEX 명령은 없습니다. 인덱스 자체가 데이터베이스 제품에 의존하는 선택적인 항목으로 취급됩니다. 하지만 대표적인 데이터베이스 제품에는 모두 인덱스 구조가 도입되어 있으며, 모두 비슷한 관리 방법으로 인덱스를 다룰 수 있습니다.

## 1.  인덱스 작성

인덱스는 `CREATE INDEX` 명령으로 만듭니다. 인덱스에 이름을 붙여 관리하는데, 데이터베이스 객체가 될지 테이블의 열처럼 취급될지는 데이터베이스 제품에 따라 다릅니다. (Oracle, DB2 : 인덱스는 스키마 객체, SQL Server, MySQL: 인덱스는 테이블 내의 객체)

인덱스를 작성할 때는 해당 인덱스가 어느 테이블의 어느 열에 관한 것인지 작성할 필요가 있습니다. 이때 열은 복수로도 지정할 수 있습니다.

~~~ sql
CREATE INDEX 인덱스명 ON 테이블명 (열명1, 열명2, ...)
~~~



## 2. 인덱스 삭제

인덱스는 `DROP INDEX` 명령으로 삭제합니다. DROP 할 때는 다른 객체와 동일하게 인덱스 이름만 지정하면 됩니다. 다만 테이블 내 객체로서 작성하는 경우에는 테이블 이름도 지정합니다(이때 인덱스를 구성하는 열은 지정할 필요가 없습니다).

~~~ sql
// DROP INDEX (스키마 객체의 경우)
DROP INDEX 인덱스명

// DROP INDEX (테이블 내 객체의 경우)
DROP INDEX 인덱스명 ON 테이블명
~~~

인덱스는 테이블에 의존하는 객체입니다. 따라서 `DROP TABLE` 로 테이블을 삭제하면 테이블에 작성된 인덱스도 자동으로 삭제됩니다.



> 인덱스를 작성해두면 **검색이 빨라집니다.**
>
> 하지만 INSERT 명령의 경우에는 인덱스를 최신 상태로 갱신하는 처리가 늘어나므로 처리속도가 조금 떨어집니다.



## 3. EXPLAIN

인덱스 작성을 통해 쿼리의 성능 향상을 기대할 수 있습니다. 이때 실제로 인덱스를 사용해 검색하는지 확인하려면 `EXPLAIN` 명령을 사용합니다.

~~~ sql
EXPLAIN SQL 명령
~~~

EXPLAIN 명령의 문법은 간단합니다. EXPLAIN에 뒤이어 확인하고 싶은 SELECT 명령 등의 SQL 명령을 지정하면 됩니다.



## 4. 최적화

SELECT 명령을 실행할 때 인덱스의 사용 여부를 선택한다는 것을 알았습니다. 이는 데이터베이스 내부의 최적화에 의해 처리되는 부분입니다. 내부 처리에서는 SELECT 명령을 실행하기에 앞서 **실행 계획**을 세웁니다. 실행계획에서는 '인덱스가 지정된 열이 WHERE 조건으로 지정되어 있으니 인덱스를 사용하자'와 같은 처리가 이루어집니다. EXPLAIN 명령은 이 실행계획을 확인하는 명령입니다.

실행계획에서는 인덱스의 유무뿐만 아니라 인덱스를 사용할 것인지 여부에 대해서도 데이터베이스 내부의 최적화 처리를 통해 판단합니다. 이때 판단 기준으로 인덱스의 품질도 고려합니다.